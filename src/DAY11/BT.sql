CREATE DATABASE BT1;
USE BT1 ;
CREATE TABLE Monhoc (
    MSMH VARCHAR(255) PRIMARY KEY,
    TENMH VARCHAR(255),
    SOTINCHI INT DEFAULT 3,
    TINHCHAT BIT CHECK (TINHCHAT IN (0, 1))
);

CREATE TABLE Lop (
    MALOP VARCHAR(255) PRIMARY KEY,
    TENLOP VARCHAR(255),
    SISO INT
);

CREATE TABLE Sinhvien (
    MSSV VARCHAR(255) PRIMARY KEY,
    HOTEN VARCHAR(255),
    NGAYSINH DATETIME,
    MALOP VARCHAR(255),
    FOREIGN KEY (MALOP) REFERENCES Lop(MALOP)
);

CREATE TABLE Diem (
    MSSV VARCHAR(255),
    MSMH VARCHAR(255),
    DIEMTHI DECIMAL(4, 1),
    PRIMARY KEY (MSSV, MSMH),
    CONSTRAINT FK_MSSV FOREIGN KEY (MSSV) REFERENCES Sinhvien(MSSV),
    CONSTRAINT FK_MSMH FOREIGN KEY (MSMH) REFERENCES Monhoc(MSMH)
);

INSERT INTO Monhoc (MSMH, TENMH, SOTINCHI, TINHCHAT) VALUES
('MH001', 'JAVA', 3, 1),
('MH002', 'C', 3, 1);

SELECT * FROM Monhoc;

INSERT INTO Lop (MALOP,TENLOP,SISO) VALUES
('JV-E075', 'JAVA', 6),
('C-E075', 'LẬP TRÌNH c', 25);

SELECT * FROM Lop;

INSERT INTO Sinhvien (MSSV, HOTEN, NGAYSINH, MALOP) VALUES
('SV001', 'Nguyen Van A', '2000-01-01', 'JV-E075'),
('SV002', 'Le Thi B', '2001-02-02', 'JV-E075'),
('SV003', 'Tran Van C', '2002-03-03', 'C-E075');

SELECT * FROM Sinhvien;

INSERT INTO Diem(MSSV,MSMH,DIEMTHI) VALUES
('SV001','MH001',9.2),
('SV001','MH002',6.2),
('SV002','MH001',8),
('SV002','MH002',8),
('SV003','MH001',10),
('SV003','MH002',1.5);

SELECT * FROM Diem;

ALTER TABLE Sinhvien ADD gioi_tinh CHAR(1) CHECK (gioi_tinh IN ('F', 'M'));

UPDATE Sinhvien SET gioi_tinh = 'M' WHERE MSSV IN ('SV001', 'SV003');
UPDATE Sinhvien SET gioi_tinh = 'F' WHERE MSSV IN ('SV002');
